---
// ProjectCard.astro - Portfolio project card component
// Displays project thumbnail, metadata, and link to case study
// Uses TypeScript for prop typing and proper accessibility

interface Props {
  // Project metadata
  title: string;
  description: string;
  slug: string;

  // Required project info
  role: string;
  tags: string[];

  // Optional fields
  image?: string;
  client?: string;
  link?: string; // Live project URL
}

// Destructure and type props
const {
  title,
  description,
  slug,
  role,
  tags,
  image,
  client,
  link,
} = Astro.props as Props;
---

<article class="card-featured group">
  {/* Project Thumbnail Image */}
  {image && (
    <div class="relative h-48 overflow-hidden bg-gray-200 mb-4">
      <img
        src={image}
        alt={`${title} project`}
        class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
        loading="lazy"
      />
      {/* Transit accent overlay on hover */}
      <div class="absolute inset-0 bg-transit-orange opacity-0 group-hover:opacity-5 transition-opacity duration-300" />

      {/* External Link Badge */}
      {link && (
        <div class="absolute top-4 right-4 bg-white rounded-full p-2 opacity-0 group-hover:opacity-100 transition-opacity">
          <svg
            class="w-5 h-5 text-transit-orange"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
            />
          </svg>
        </div>
      )}
    </div>
  )}

  {/* Content Container */}
  <div class="p-6">
    {/* Title */}
    <h2 class="text-2xl font-pixel text-transit-charcoal mb-2 group-hover:text-transit-orange transition-colors">
      <a href={`/portfolio/${slug}`} class="no-underline hover:text-transit-orange">
        {title}
      </a>
    </h2>

    {/* Transit Line Separator */}
    <div class="transit-line-thin mb-4"></div>

    {/* Client and Role Info */}
    <div class="mb-4 text-sm text-gray-600">
      {client && (
        <div class="mb-2">
          <span class="font-medium">Client:</span> {client}
        </div>
      )}
      <div>
        <span class="font-medium">Role:</span> {role}
      </div>
    </div>

    {/* Description */}
    <p class="text-gray-700 mb-4 line-clamp-2">
      {description}
    </p>

    {/* Tags */}
    {tags && tags.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-4">
        {tags.map((tag) => (
          <span class="tag-accent">
            {tag}
          </span>
        ))}
      </div>
    )}

    {/* Action Links */}
    <div class="flex gap-3">
      {/* Case Study Link */}
      <a
        href={`/portfolio/${slug}`}
        class="inline-flex items-center gap-2 text-transit-orange font-medium hover:gap-3 transition-all group/link"
        aria-label={`View ${title} case study`}
      >
        View Case Study
        <svg
          class="w-4 h-4 transition-transform group-hover/link:translate-x-1"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </a>

      {/* External Project Link */}
      {link && (
        <a
          href={link}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 text-gray-600 hover:text-transit-orange font-medium transition-colors"
          aria-label={`Visit live ${title} project`}
        >
          View Live
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
            />
          </svg>
        </a>
      )}
    </div>
  </div>
</article>

<style>
  /* Card hover effects */
  article {
    cursor: pointer;
  }

  /* Line clamping for description text */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Responsive image height */
  @media (max-width: 640px) {
    .h-48 {
      height: 12rem;
    }
  }
</style>
