---
// BlogCard.astro - Blog post card component with magazine-style layout
// Displays blog metadata, featured image, and link to full post
// Uses TypeScript for prop typing and proper accessibility

interface Props {
  // Post metadata
  title: string;
  description: string;
  pubDate: Date;
  slug: string;

  // Optional fields
  tags?: string[];
  image?: string;
  author?: string;
}

// Destructure and type props
const {
  title,
  description,
  pubDate,
  slug,
  tags = [],
  image,
  author = 'Cody',
} = Astro.props as Props;

// Format date for display: "Jan 13, 2025"
const formattedDate = pubDate.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
});
---

<article class="card-featured group">
  {/* Featured Image */}
  {image && (
    <div class="relative h-48 overflow-hidden bg-gray-200 mb-4">
      <img
        src={image}
        alt={title}
        class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
        loading="lazy"
      />
      {/* Transit accent overlay on hover */}
      <div class="absolute inset-0 bg-transit-orange opacity-0 group-hover:opacity-5 transition-opacity duration-300" />
    </div>
  )}

  {/* Content Container */}
  <div class="p-6">
    {/* Header with Date */}
    <div class="flex items-start justify-between mb-3 gap-4">
      <div>
        {/* Post Title */}
        <h2 class="text-2xl font-pixel text-transit-charcoal mb-2 group-hover:text-transit-orange transition-colors">
          <a href={`/blog/${slug}`} class="no-underline hover:text-transit-orange">
            {title}
          </a>
        </h2>

        {/* Publication Date and Author */}
        <time
          datetime={pubDate.toISOString()}
          class="text-sm text-gray-600"
        >
          {formattedDate}
          {author && <span class="text-gray-500"> â€¢ {author}</span>}
        </time>
      </div>
    </div>

    {/* Transit Line Separator */}
    <div class="transit-line-thin mb-4"></div>

    {/* Description */}
    <p class="text-gray-700 mb-4 line-clamp-3">
      {description}
    </p>

    {/* Tags */}
    {tags && tags.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-4">
        {tags.map((tag) => (
          <span class="tag-accent">
            {tag}
          </span>
        ))}
      </div>
    )}

    {/* Read More Link */}
    <a
      href={`/blog/${slug}`}
      class="inline-flex items-center gap-2 text-transit-orange font-medium hover:gap-3 transition-all group/link"
      aria-label={`Read article: ${title}`}
    >
      Read Article
      <svg
        class="w-4 h-4 transition-transform group-hover/link:translate-x-1"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 5l7 7-7 7"
        />
      </svg>
    </a>
  </div>
</article>

<style>
  /* Card hover effects */
  article {
    cursor: pointer;
  }

  /* Line clamping for description text */
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Responsive image height */
  @media (max-width: 640px) {
    .h-48 {
      height: 12rem;
    }
  }
</style>
